generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model cliente {
  id_cliente Int        @id @default(autoincrement())
  nombre     String
  apellido   String
  dni        String     @db.VarChar(10)
  direccion  String

  presupuestos presupuesto[]
}

model rol {
  id_rol     Int      @id @default(autoincrement())
  nombre_rol String

  usuarios  usuario[]
}

model usuario {
  id_usuario Int     @id @default(autoincrement())
  id_rol     Int
  nombre     String
  apellido   String
  dni        String
  email      String  @unique
  contrasena String

  rol       rol     @relation(fields: [id_rol], references: [id_rol])
  veterinario veterinario?
  presupuestos presupuesto[]
}

model veterinario {
  id_usuario Int     @id
  matricula  String

  usuario    usuario @relation(fields: [id_usuario], references: [id_usuario])
}

model animal {
  id_animal        Int      @id @default(autoincrement())
  peso             Int
  sexo             String
  estado           String
  fecha_nacimiento DateTime @db.Date
  vacunado         Boolean

  procedimientos procedimiento_veterinario[]
  detalles        detalle_presupuesto[]
}

model procedimiento_veterinario {
  id_procedimiento_veterinario Int      @id @default(autoincrement())
  tipo                         String
  fecha                        DateTime  @db.Date
  id_animal                    Int

  animal animal @relation(fields: [id_animal], references: [id_animal])
}

model metodo_pago {
  id_metodo_pago     Int     @id @default(autoincrement())
  nombre_metodo_pago String

  cobros cobro[]
}

model cobro {
  id_cobro       Int       @id @default(autoincrement())
  importe_total  Decimal   @db.Decimal(10,2)
  fecha          DateTime  @db.Date
  id_metodo_pago Int

  metodo_pago    metodo_pago @relation(fields: [id_metodo_pago], references: [id_metodo_pago])
  transferencia  transferencia?
  tarjeta        tarjeta?
  factura_ventas factura_venta[]
}

model transferencia {
  id_cobro Int @id
  titular  String
  cuil     String

  cobro    cobro @relation(fields: [id_cobro], references: [id_cobro])
}

model tarjeta {
  id_cobro      Int    @id
  titular        String

  cobro         cobro @relation(fields: [id_cobro], references: [id_cobro])
}

model factura_venta {
  id_factura_venta Int      @id @default(autoincrement())
  importe_total    Int
  fecha            DateTime @db.Date
  tipo             String
  id_cobro         Int

  cobro        cobro         @relation(fields: [id_cobro], references: [id_cobro])
  presupuestos presupuesto[]
}

model presupuesto {
  id_presupuesto    Int      @id @default(autoincrement())
  importe_total     Int
  fecha             DateTime @db.Date
  id_cliente        Int
  id_factura_venta  Int
  id_usuario        Int

  cliente           cliente       @relation(fields: [id_cliente], references: [id_cliente])
  usuario           usuario       @relation(fields: [id_usuario], references: [id_usuario])
  factura_venta     factura_venta @relation(fields: [id_factura_venta], references: [id_factura_venta])
  detalles          detalle_presupuesto[]
}

model detalle_presupuesto {
  id_detalle_presupuesto Int @id @default(autoincrement())
  id_presupuesto         Int
  id_animal              Int
  precio                 Int

  presupuesto  presupuesto @relation(fields: [id_presupuesto], references: [id_presupuesto])
  animal       animal      @relation(fields: [id_animal], references: [id_animal])
}